#pragma once
#include "Vector.hpp"
#include "Block.hpp"

namespace GameEntity
{
    enum Direction
    {
        None = 0, Clockwise, CounterClockwise
    };

    // Array of Tetromino shapes in Vector(x, y)
    // TetrominoType[shape][rotation][blocks]
    static const Vector TetrominoType[8][4][4] =
    {   // EMPTY
        {
            {{-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}},
            {{-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}},
            {{-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}},
            {{-1, -1}, {-1, -1}, {-1, -1}, {-1, -1}}
        },
        // I
        {
            {{0, 1}, {1, 1}, {2, 1}, {3, 1}},
            {{2, 0}, {2, 1}, {2, 2}, {2, 3}},
            {{0, 2}, {1, 2}, {2, 2}, {3, 2}},
            {{1, 0}, {1, 1}, {1, 2}, {1, 3}}
        },
        // O
        {
           {{1, 0}, {2, 0}, {1, 1}, {2, 1}},
           {{1, 0}, {2, 0}, {1, 1}, {2, 1}},
           {{1, 0}, {2, 0}, {1, 1}, {2, 1}},
           {{1, 0}, {2, 0}, {1, 1}, {2, 1}}
        },
        // T
        {
           {{1, 0}, {0, 1}, {1, 1}, {2, 1}},
           {{1, 0}, {1, 1}, {2, 1}, {1, 2}},
           {{0, 1}, {1, 1}, {2, 1}, {1, 2}},
           {{1, 0}, {0, 1}, {1, 1}, {1, 2}}
        },
        // J
        {
            {{0, 0}, {0, 1}, {1, 1}, {2, 1}},
            {{1, 0}, {2, 0}, {1, 1}, {1, 2}},
            {{0, 1}, {1, 1}, {2, 1}, {2, 2}},
            {{1, 0}, {1, 1}, {1, 2}, {0, 2}}
        },
        // L
        {
            {{2, 0}, {0, 1}, {1, 1}, {2, 1}},
            {{1, 0}, {1, 1}, {1, 2}, {2, 2}},
            {{0, 1}, {1, 1}, {2, 1}, {0, 2}},
            {{1, 0}, {2, 0}, {2, 1}, {2, 2}}
        },
        // S
        {
            {{1, 0}, {2, 0}, {0, 1}, {1, 1}},
            {{1, 0}, {1, 1}, {2, 1}, {2, 2}},
            {{1, 1}, {2, 1}, {0, 2}, {1, 2}},
            {{0, 0}, {0, 1}, {1, 1}, {1, 2}}
        },
        // Z
        {
            {{0, 0}, {1, 0}, {1, 1}, {2, 1}},
            {{2, 0}, {1, 1}, {2, 1}, {1, 2}},
            {{0, 1}, {1, 1}, {1, 2}, {2, 2}},
            {{1, 0}, {0, 1}, {1, 1}, {0, 2}},
        }
    };

    class Tetromino
    {
    private:
        int m_rotation;
    public:
        static const int blockCount = 4;
        int id;
        BlockType type;
        const Vector *blockPosition;
        Tetromino(int id, BlockType type);
        const Vector * peek();
        void rotate(Direction);
    };
};
